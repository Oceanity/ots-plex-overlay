$(function(){function t(t,e){l.html(r(t)),s.width(`${100*t/e}%`)}function r(t){let r=Math.floor(t/1e3%60),e=Math.floor(t/6e4%60),n=Math.floor(t/36e5%24),o=0!==n&&n<10?"0"+n:n,a=0!==n&&e<10?"0"+e:e,i=r<10?"0"+r:r;return`${o?o+":":""}${a}:${i}`}let e={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(t,r,n)=>{e[r]=n});const n=$("body"),o=$("#art-image"),a=$("#track-title"),i=$("#track-artist"),c=$("#track-album"),l=$("#track-current"),u=$("#track-total"),s=$("#current-progress"),f=250;let m={};currentTime=0,isPlaying=!1;setInterval(function(){isPlaying&&(currentTime+=1e3,t(currentTime,m.duration))},1e3);const d=io("/plex-overlay");d.on("connect",()=>{console.log("[Connected to server]"),d.emit("handshake",{})}),d.on("track-info",e=>{m=e,isPlaying=e.playing,e.playing?(a.html(e.title||""),i.html(e.artist||""),c.html(e.album||""),u.html(` / ${r(e.duration)}`),e.offset<currentTime&&(console.log(`Time Off! server: ${e.offset} client: ${currentTime}`),currentTime=e.offset,t(currentTime,e.duration)),e.art&&e.art!==o.attr("src")?(o.attr("src",null),o.ready(function(){n.fadeIn(f)}),o.attr("src",e.art)):(e.art||o.attr("src",null),n.fadeIn(f))):n.fadeOut(f)}),d.on("tick",r=>{console.log("tock"),currentTime=r,t(r,m.duration)})});